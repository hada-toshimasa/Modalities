<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>物療マニュアル 完全攻略マスター（上級編）</title>
<style>
    body { font-family: "Helvetica Neue", Arial, sans-serif; line-height: 1.6; color: #333; background-color: #e0f7fa; margin: 0; padding: 20px; }
    .container { max-width: 800px; margin: 0 auto; background: #fff; padding: 25px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.08); position: relative; }
    h1 { text-align: center; color: #0097a7; margin-bottom: 25px; font-size: 1.8em; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .reset-btn { position: absolute; top: 20px; right: 20px; background: #95a5a6; color: #fff; border: none; padding: 6px 12px; border-radius: 4px; cursor: pointer; font-size: 0.85em; transition: 0.3s; }
    .reset-btn:hover { background: #7f8c8d; }
    .status-bar { background: #e0f2f1; padding: 12px 20px; border-radius: 8px; display: flex; justify-content: space-between; color: #00695c; font-weight: bold; margin-bottom: 25px; }
    .question-box { background: #f1f8e9; border-left: 6px solid #0097a7; padding: 20px; margin-bottom: 25px; font-size: 1.15em; font-weight: bold; line-height: 1.5; }
    .option-btn { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background: #fff; border: 2px solid #e0e0e0; border-radius: 8px; text-align: left; cursor: pointer; transition: all 0.2s; font-size: 1em; color: #444; }
    .option-btn:hover { background-color: #e0f7fa; border-color: #0097a7; }
    .option-btn.correct { background-color: #d4edda; border-color: #28a745; color: #155724; }
    .option-btn.incorrect { background-color: #f8d7da; border-color: #dc3545; color: #721c24; }
    .feedback { display: none; margin-top: 20px; padding: 20px; border-radius: 8px; background: #f1f8e9; border: 1px solid #c8e6c9; color: #2e7d32; animation: fadeIn 0.3s; }
    .feedback.error { background: #fdecea; border: 1px solid #fadbd8; color: #7b241c; }
    .source-ref { display: block; margin-top: 8px; font-size: 0.85em; color: #666; text-align: right; font-style: italic; }
    .next-btn { display: block; width: 100%; padding: 18px; background: #0097a7; color: #fff; border: none; border-radius: 8px; font-size: 1.2em; font-weight: bold; cursor: pointer; margin-top: 25px; opacity: 0.6; pointer-events: none; transition: 0.3s; }
    .next-btn.active { opacity: 1; pointer-events: auto; }
    .next-btn:hover { background-color: #006064; }
    #result-screen { display: none; text-align: center; padding: 20px; }
    .score-circle { width: 150px; height: 150px; background: #0097a7; color: #fff; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin: 30px auto; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
    .score-num { font-size: 3.5em; font-weight: bold; line-height: 1; }
    .score-label { font-size: 0.9em; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
</style>
</head>
<body>
<div class="container">
    <div id="start-screen" style="text-align: center; padding: 40px 0;">
        <h1 style="border: none;">物療マニュアル<br>完全攻略マスター（上級編）</h1>
        <p style="font-size: 1.1em; margin-bottom: 30px;">全60問のプールから<br>毎回ランダムに20問出題されます。</p>
        <p style="font-size: 0.9em; color: #7f8c8d; margin-bottom: 40px;">合格ライン: 80%以上</p>
        <button class="next-btn active" onclick="startQuiz()">試験を開始する</button>
    </div>

    <div id="quiz-screen" style="display: none;">
        <button class="reset-btn" onclick="resetQuiz()">最初に戻る</button>
        <h1>物療クイズ</h1>
        <div class="status-bar">
            <span id="progress">問 1 / 20</span>
            <span id="score">正解数: 0</span>
        </div>
        <div id="question" class="question-box"></div>
        <div id="options"></div>
        <div id="feedback" class="feedback"></div>
        <button id="next-btn" class="next-btn" onclick="nextQuestion()">次の問題へ</button>
    </div>

    <div id="result-screen">
        <h2>試験終了</h2>
        <div class="score-circle">
            <span class="score-num" id="final-score">0</span>
            <span class="score-label">点 / 20点</span>
        </div>
        <p id="result-comment" style="font-size: 1.2em; margin: 20px 0;"></p>
        <button class="next-btn active" onclick="resetQuiz(true)">もう一度挑戦する</button>
    </div>
</div>

<script>
// --- 問題プール Part 1 (1-30: 電気療法の基礎・病態生理) ---
const poolPart1 = [
    {q:"ゲートコントロール理論において、Aβ線維（触圧覚）を刺激することの生理学的意義は？",o:["脊髄後角の膠様質（SG）を活性化し、痛覚伝達（T細胞）を抑制する","脳内モルヒネ様物質の分泌を促進する","筋収縮を引き起こし、血流を改善する","発痛物質を洗い流す"],c:0,r:"太いAβ線維からの入力が、脊髄レベルでゲートを閉じる（SG細胞を活性化し、痛みを伝えるT細胞を抑制する）ことで鎮痛効果を発揮します。",s:"8ページ"},
    {q:"筋阻血性疼痛の発生メカニズムとして正しい順序は？",o:["筋緊張亢進 → 血管圧迫・虚血 → 発痛物質産生 → C線維興奮","筋弛緩 → 血流増大 → 発痛物質産生 → Aδ線維興奮","筋緊張亢進 → 血管拡張 → 発痛物質除去 → C線維抑制","筋萎縮 → 神経変性 → 疼痛発生"],c:0,r:"筋スパズムによる内圧上昇が微小循環を阻害し（虚血）、ブラジキニン等の発痛物質が蓄積され、C線維（ポリモーダル受容器）を刺激します。",s:"9ページ"},
    {q:"「パルス幅」を長く設定（400〜1000µs）することの臨床的意義は？",o:["感覚神経のみを選択的に刺激し、不快感を減らす","運動神経の脱分極を確実にし、深部筋や高負荷トレーニング効果を得る","皮膚抵抗を減らし、火傷のリスクを下げる","周波数を高くして、鎮痛効果を高める"],c:1,r:"パルス幅が広いほど総電気量が増え、閾値の高い運動神経や深部組織まで興奮させやすくなります（SD曲線に基づく）。",s:"5ページ"},
    {q:"急性痛（一次痛）に対するハイボルト療法の推奨設定（周波数・パルス幅）とその根拠は？",o:["1-10Hz / 50-100µs：エンドルフィン分泌による持続的鎮痛","100-200Hz / 10-20µs：ゲートコントロール理論に基づく即時鎮痛","30-50Hz / 200µs：筋ポンプ作用による発痛物質除去","DC通電：組織修復促進"],c:1,r:"Aδ線維由来の鋭い痛みには、高頻度（100Hz以上）・短パルス（Aβ選択刺激）でゲートコントロールを働かせるのが効果的です。",s:"13ページ"},
    {q:"慢性痛（二次痛）に対するハイボルト療法で、交感神経を「抑制」させる設定（1-15Hz等）にする目的は？",o:["血管を収縮させ、腫脹を引かせるため","血管を拡張させ、虚血状態を改善し発痛物質を洗い流すため","運動神経を遮断し、筋緊張を落とすため","知覚神経を麻痺させるため"],c:1,r:"慢性痛の多くは交感神経緊張による血管収縮・虚血が背景にあるため、低頻度刺激で交感神経活動を抑え、血流改善を図ります。",s:"14ページ"},
    {q:"TENSとマイクロカレント（MCR）の決定的な違いは？",o:["TENSは筋収縮を伴うが、MCRは伴わない","TENSは神経を脱分極させる（活動電位を生じさせる）が、MCRはさせない（閾値下刺激）","TENSは組織修復、MCRは鎮痛が主目的","違いはない"],c:1,r:"MCRは生体電流に近い微弱電流（μA）であり、神経を興奮させずに細胞レベルの修復（ATP産生など）を促進します。",s:"17ページ"},
    {q:"ロシアンカレント（2500Hzの中周波）が筋力強化に有効とされる理由は？",o:["皮膚抵抗が低く、かつ強い電流で深部筋まで強力に収縮させられるから","低周波なので、遅筋線維を選択的に鍛えられるから","熱産生により筋温が上がり、出力が上がるから","痛みが全くないから"],c:0,r:"中周波（2.5kHz）をバースト状に発振することで、不快感を抑えつつ高強度の筋収縮（テタヌス）を誘発できます。",s:"18ページ"},
    {q:"超音波治療器において、深部（筋・関節包など）を温熱する場合の適切な周波数と照射率は？",o:["3MHz / 20%（非温熱）","1MHz / 100%（連続波）","3MHz / 100%（連続波）","1MHz / 20%（非温熱）"],c:1,r:"1MHzは深部まで届き、100%（連続波）は熱産生効果が高いため、深部組織の伸張性改善などに適しています。",s:"2ページ"},
    {q:"電気刺激による「筋ポンプ作用」を最大限に引き出すための周波数設定は？",o:["100Hz以上の強縮","1Hz〜10Hzの単収縮（Twitch）の繰り返し","50Hz程度の強縮（Tetanus）","0Hz（直流）"],c:1,r:"筋肉をリズミカルに収縮・弛緩させる（単収縮）ことで、静脈還流を促進し、浮腫や発痛物質を除去します。",s:"7ページ"},
    {q:"「スウィープ波形（変調波）」を用いる生理学的なメリットは？",o:["特定の神経線維のみを狙い撃ちできる","神経の順応（慣れ）を防ぎ、治療効果を持続させる","電圧を一定に保ち、安全性を高める","深部到達度を下げる"],c:1,r:"同一の刺激が続くと神経は反応しなくなる（順応）ため、周波数を揺らぐことで常に新鮮な刺激として認識させます。",s:"13ページ"},
    {q:"Aδ線維とC線維の伝導速度と痛みの性質の違いとして正しい組み合わせは？",o:["Aδ：遅い・鈍痛 ／ C：速い・鋭痛","Aδ：速い・鋭痛（局在明瞭） ／ C：遅い・鈍痛（局在不明瞭）","Aδ：無髄・灼熱痛 ／ C：有髄・刺痛","両者に違いはない"],c:1,r:"Aδは有髄で速く（一次痛）、Cは無髄で遅い（二次痛）のが特徴です。C線維は情動的・自律神経的な反応も引き起こします。",s:"10ページ"},
    {q:"ハイボルト療法で「スウィープ 1〜15Hz」を選択すべき病態は？",o:["受傷直後の急性捻挫（腫脹あり）","慢性の肩こり・腰痛（筋緊張・虚血あり）","知覚過敏のある神経痛","筋断裂の急性期"],c:1,r:"低周波領域のスウィープは、エンドルフィン分泌や血管拡張（交感神経抑制）効果が高く、慢性的な痛みや凝りに適しています。",s:"14ページ"},
    {q:"微弱電流（MCR）が「損傷電流」の代わりになると言われる理由は？",o:["組織損傷時に発生する内因性電流と似た極性と強さを持つから","神経を麻痺させるから","血管を収縮させて出血を止めるから","カルシウムイオンを沈着させるから"],c:0,r:"人体は損傷すると微弱な「損傷電流」を流して修復を始めますが、MCRはこれを人工的に補い、修復プロセスを加速させます。",s:"17ページ"},
    {q:"EMSによる筋収縮が、随意運動（自分で動かす）と異なる点は？",o:["サイズの小さい遅筋線維から動員される（サイズの原理通り）","サイズの大きい速筋線維から優先的に動員される（逆サイズの原理）","疲労しにくい","エネルギー消費が少ない"],c:1,r:"電気刺激は太い神経（速筋支配）を興奮させやすいため、通常とは逆に、疲れやすい速筋から動員される特徴があります。",s:"18ページ"},
    {q:"高周波（10kHz以上）が「深部加温」に適している物理的な理由は？",o:["波長が長く、回折しやすいから","周波数が高いほど組織（容量性抵抗）を通過しやすくなるから","電圧が高いから","磁気が発生するから"],c:1,r:"生体組織はコンデンサのような性質を持ち、周波数が高いほど電気を通しやすくなるため、深部でジュール熱を発生させられます。",s:"6ページ"},
    {q:"「干渉波（IF）」において、4000Hzと4050Hzの電流を交差させた時に体内で発生する「干渉電流」の周波数は？",o:["4000Hz","8050Hz","50Hz（差分）","2000Hz"],c:2,r:"2つの周波数の差（ビート周波数）が、深部での治療周波数（低周波）として作用します。",s:"3ページ"},
    {q:"疼痛コントロールにおいて、Aβ線維を選択的に刺激するためのパルス幅は？",o:["広い（300µs以上）","狭い（50〜100µs程度）","変動させる","設定しない"],c:1,r:"Aβ線維（感覚神経）はクロナキシー（時値）が短いため、狭いパルス幅でも十分に興奮し、不快な筋収縮や痛覚刺激を避けられます。",s:"5ページ"},
    {q:"筋収縮を伴わない電気刺激（TENSの感覚レベルなど）でも鎮痛効果が得られるメカニズムは？",o:["下行性疼痛抑制系の賦活","ゲートコントロール理論による脊髄後角での抑制","内因性オピオイドの放出","筋ポンプ作用"],c:1,r:"心地よい感覚刺激（Aβ）を入れるだけで、脊髄レベルでの痛みの遮断（ゲートを閉じる）が起こります。",s:"8ページ"},
    {q:"物理療法のリスク管理として、悪性腫瘍患者への電気療法が禁忌とされる理由は？",o:["腫瘍細胞の代謝や血流を促進し、増殖・転移を早める恐れがあるため","痛みが強くなるから","皮膚が弱っているから","骨折しやすいから"],c:0,r:"組織の活性化や血流増大は、がん細胞にとっても有利に働く危険性があるため、原則禁忌です。",s:"一般知識"},
    {q:"急性期のアイシング（寒冷療法）と併用して効果的な電気療法設定は？",o:["100Hz以上のTENS（ゲートコントロール）","1HzのEMS（筋収縮）","超音波（温熱）","干渉波（強刺激）"],c:0,r:"冷却による感覚入力低下と、高頻度TENSによるゲートコントロールの相乗効果で、強力な鎮痛が期待できます。",s:"13ページ"},
    {q:"神経障害性疼痛（痺れ・放散痛）に対して、ハイボルト療法を行う際の電極配置の基本は？",o:["痛い場所だけを挟む","神経の走行（絞扼部）と末梢の症状部、または脊髄分節（神経根）に通電する","健側に貼る","頭部に貼る"],c:1,r:"末梢の痛みだけでなく、原因となっている神経根や絞扼ポイント（エントラップメントポイント）を狙うことが重要です。",s:"一般知識"},
    {q:"「1/f ゆらぎ」モードを搭載した電気治療器の生理学的メリットは？",o:["筋力がつく","生体リズムと共鳴し、リラクゼーション効果を高め、不快感を軽減する","深部に届く","炎症を抑える"],c:1,r:"心拍や脳波など生体信号に含まれるゆらぎと同じリズム刺激は、自律神経を整え快適性を高めます。",s:"一般知識"},
    {q:"骨癒合不全（偽関節）に対して、LIPUS（低出力超音波パルス）が推奨される理由は？",o:["骨を温めて血流を良くするから","微弱な機械的振動（圧電効果）が骨形成細胞を刺激し、骨癒合を促進するから","神経を麻痺させて痛りを取るから","筋肉を鍛えるから"],c:1,r:"温熱効果（Thermal）ではなく、音圧刺激（Non-thermal）が骨芽細胞の活性化などを引き起こします。",s:"2ページ"},
    {q:"ガルバニック電流（直流通電）を用いた治療における、陰極（－）側の生理作用は？",o:["鎮静・鎮痛・血管収縮","興奮・組織軟化・血管拡張","変化なし","冷却"],c:1,r:"陰極下ではアルカリ性反応が生じ、組織を軟らかくし、神経興奮性を高める（リハビリ向き）作用があります。陽極は鎮静です。",s:"一般知識"},
    {q:"電気刺激における「デューティ比（Duty Cycle）」とは何を意味するか？",o:["周波数の高さ","通電時間と休止時間の比率","電圧と電流の比率","左右の出力差"],c:1,r:"EMSなどで「5秒収縮・10秒休止」のように設定する比率。筋疲労を防ぎながらトレーニングするために重要です。",s:"5ページ"},
    {q:"SSP療法（銀錐粒）が「刺さない鍼」と呼ばれる所以たる作用機序は？",o:["ゲートコントロール理論","広汎性侵害抑制調節（DNIC）や圧発汗反射","プラセボ効果","筋ポンプ作用"],c:1,r:"局所への高密度な刺激が、鍼治療と同様の機序（下行性抑制や内因性オピオイド）で鎮痛をもたらすとされます。",s:"一般知識"},
    {q:"寒冷療法（Cryotherapy）が生体に及ぼす影響で誤っているのは？",o:["神経伝導速度の低下","代謝率の低下","コラーゲン組織の伸張性増大","筋スパズムの軽減（二次的）"],c:2,r:"冷やすと組織は硬くなり、伸張性は低下します。伸張性を出すなら温熱です。",s:"一般知識"},
    {q:"温熱療法において、金属インプラントが入っている部位への超音波・短波の使用が注意（禁忌）な理由は？",o:["金属が電波を反射するから","金属の熱伝導率・吸収率が高く、周囲組織を含めて火傷を起こすリスクがあるから","金属が溶けるから","機械が壊れるから"],c:1,r:"体内金属が過熱され、深部火傷（ホットスポット）を引き起こす危険性があります。",s:"一般知識"},
    {q:"物理療法機器の安全管理として、使用前に必ず確認すべきことは？",o:["電源コードの破損や、導子（プローブ・パッド）の劣化・亀裂の有無","前日の天気","患者の好みの音楽","室温"],c:0,r:"コードの断線やパッドの劣化は、感電や火傷の直接的な原因となるため、日常点検が必須です。",s:"一般知識"},
    {q:"EMSによる筋力増強効果を最大化するために、患者に指導すべきことは？",o:["寝ているだけで良いと伝える","電気刺激に合わせて、自分でも意識的に力を入れる（随意収縮の併用）","痛みを我慢させる","息を止めるように言う"],c:1,r:"電気刺激に随意収縮を重ねる（Superimposed）ことで、より多くの運動単位を動員でき、トレーニング効果が高まります。",s:"18ページ"}
];
    // --- 問題プール Part 2 (31-60: 応用知識・臨床判断) ---
const poolPart2 = [
    {q:"EMSで鍛えられる筋線維の特徴は？（随意運動との違い）",o:["速筋線維から優先的に動員される","遅筋線維から動員される","随意運動と同じ","中間筋のみ"],c:0,r:"電気刺激は、通常の運動では鍛えにくい「速筋線維」を優先的に動員する特徴があります。",s:"18ページ"},
    {q:"マイクロカレント（MCR）の電流レベルはどのくらいか？",o:["μA（マイクロアンペア）","mA（ミリアンペア）","A（アンペア）","V（ボルト）"],c:0,r:"知覚できないほどの微弱電流（μA）を使用します。",s:"17ページ"},
    {q:"ATP（アデノシン三リン酸）の産生を促進する電気療法は？",o:["マイクロカレント","ハイボルト","EMS","TENS"],c:0,r:"マイクロカレントはATP産生を促し、細胞のエネルギー代謝を活性化します。",s:"17ページ"},
    {q:"電気療法における「スウィープ波形」の主な目的は？",o:["神経の順応（慣れ）を防ぐ","電圧を上げる","時間を短縮する","温める"],c:0,r:"周波数を変動させることで、体が刺激に慣れて効果が薄れるのを防ぎます。",s:"13ページ"},
    {q:"ハイボルト療法で、浮腫（腫れ）を引かせたい場合のターゲット神経への作用は？",o:["交感神経の興奮（血管収縮）","交感神経の抑制（血管拡張）","運動神経の遮断","感覚神経の興奮"],c:0,r:"急性期の腫脹に対しては、交感神経を興奮させ血管を収縮させる設定にします。",s:"13ページ"},
    {q:"ハイボルト療法で、慢性的な血行不良を改善したい場合のターゲット神経への作用は？",o:["交感神経の興奮","交感神経の抑制（血管拡張）","運動神経の遮断","感覚神経の興奮"],c:1,r:"慢性期は血流を改善するため、交感神経を抑制し血管を拡張させる設定にします。",s:"14ページ"},
    {q:"「筋ポンプ作用」を促進するために適した周波数は？",o:["低い周波数（数Hz〜20Hz程度）","高い周波数（100Hz以上）","超高周波","0Hz"],c:0,r:"筋肉をドクンドクンと大きく動かす低頻度の刺激が、ポンプ作用による血流改善に適しています。",s:"7ページ"},
    {q:"「廃用性萎縮」の予防に効果的な電気療法は？",o:["EMS","TENS","マイクロカレント","超音波"],c:0,r:"電気刺激により筋収縮を起こすEMSは、長期安静時の筋萎縮予防に有効です。",s:"7ページ"},
    {q:"「1/f ゆらぎ」のリズムを取り入れた電気刺激の目的は？",o:["リラックス効果と順応防止","筋力強化","脂肪燃焼","殺菌"],c:0,r:"自然界のリズムに近い刺激で、不快感を減らしリラックス効果を高めます。",s:"一般知識"},
    {q:"干渉波治療器（IF）の特徴は？",o:["異なる周波数の電流を体内で交差させ、深部で干渉低周波を発生させる","皮膚抵抗が高い","浅層のみ刺激する","直流電流を使う"],c:0,r:"皮膚抵抗の低い中周波を使い、体内で干渉させることで深部まで刺激を届けます。",s:"3ページ"},
    {q:"「疼痛緩和」を目的としたパルス幅の設定は？",o:["短い（10〜200µs）","長い（500µs以上）","中くらい","極めて長い"],c:0,r:"感覚神経（Aβ線維）を選択的に刺激するため、短いパルス幅が適しています。",s:"5ページ"},
    {q:"「筋収縮」を目的としたパルス幅の設定は？",o:["中程度〜長い（200µs以上）","極めて短い","ゼロ","変動させる"],c:0,r:"運動神経を脱分極させるには、ある程度のパルス幅（持続時間）が必要です。",s:"5ページ"},
    {q:"高電圧電気刺激療法（ハイボルト）の最大の特徴は？",o:["深部到達度が高く、即効性がある","皮膚が焼ける","痛みが強い","時間がかかる"],c:0,r:"高電圧で皮膚抵抗を突破し、深部組織まで刺激を到達させることができます。",s:"3ページ"},
    {q:"侵害受容器のAδ線維が伝える痛みは？",o:["鋭利な痛み（Fast pain）","鈍い痛み（Slow pain）","痒み","痺れ"],c:0,r:"Aδ線維は伝達速度が速く、鋭い痛み（Fast pain）を伝えます。",s:"10ページ"},
    {q:"侵害受容器のC線維が伝える痛みは？",o:["鈍い痛み（Slow pain）","鋭利な痛み","冷たさ","触覚"],c:0,r:"C線維は伝達速度が遅く、鈍い痛み（Slow pain）を伝えます。",s:"10ページ"},
    {q:"痛みの伝達物質として、C線維の主体となるものは？",o:["グルタミン酸","CGRP（カルシトニン遺伝子関連ペプチド）","アセチルコリン","ドーパミン"],c:1,r:"C線維はポリモーダル受容器に接続し、CGRPなどが関与します。Aδ線維はグルタミン酸が主体です。",s:"10ページ"},
    {q:"物理療法の3大エネルギーのうち「衝撃波」の主な適応組織は？",o:["腱・骨・痙性","神経のみ","皮膚のみ","血管のみ"],c:0,r:"衝撃波は難治性の腱付着部炎、骨癒合不全、痙性（痙縮）などに用いられます。",s:"2ページ"},
    {q:"超音波治療器の温熱効果はどの分類に入るか？",o:["深部加熱","伝導加温","輻射熱","対流熱"],c:0,r:"超音波振動による摩擦熱で、体の奥（深部）を温めます。",s:"2ページ"},
    {q:"ホットパックの温熱区分は？",o:["伝導加温","深部加熱","変換熱","輻射熱"],c:0,r:"熱源を直接体に当てることで熱が伝わる伝導加温です。",s:"2ページ"},
    {q:"「ゲートコントロール理論」を提唱した人物は？",o:["Melzack と Wall","Newton","Einstein","Hippocrates"],c:0,r:"1965年にメルザックとウォールによって提唱されました。",s:"8ページ"},
    {q:"電気刺激による鎮痛効果で、脳内麻薬物質と呼ばれるものは？",o:["エンドルフィン","アドレナリン","インスリン","ヒスタミン"],c:0,r:"低周波刺激などで分泌が促進され、鎮痛作用をもたらします。",s:"7ページ"},
    {q:"RUSS（ロシアンカレント）の主な目的は？",o:["筋力強化（筋肉の再教育）","リラクゼーション","創傷治癒","骨癒合"],c:0,r:"2500Hzの中周波を用いた、強力な筋収縮を促すプログラムです。",s:"3ページ"},
    {q:"DC（ダイレクトカレント）とはどんな電流か？",o:["直流電流","交流電流","干渉波","高周波"],c:0,r:"一方向に流れ続ける電流で、イオン導入や組織修復などに使われます。",s:"3ページ"},
    {q:"30〜80Hzの周波数で期待できる効果は？",o:["筋弛緩・血流促進","即時鎮痛","筋力増強","神経遮断"],c:0,r:"筋肉をほぐし、血行を良くするのに適した周波数帯です。",s:"11ページ"},
    {q:"ハイボルト療法で、反応閾値「以下」の弱め刺激で行う目的は？",o:["組織修復・微細な循環改善","筋力強化","即時鎮痛","麻痺の改善"],c:0,r:"強い収縮を伴わない刺激で、細胞レベルの活性化や微小循環の改善を狙います。",s:"14ページ"},
    {q:"物理療法禁忌となる患者の状態は？",o:["ペースメーカー装着者","高血圧（管理下）","糖尿病（管理下）","高齢者"],c:0,r:"心臓ペースメーカーなどの体内植込型医用電子機器を使用している方は禁忌です。",s:"一般知識"},
    {q:"急性の炎症（腫れ・熱感）がある患部への温熱療法は？",o:["禁忌（行ってはいけない）","推奨される","どちらでもよい","短時間なら良い"],c:0,r:"急性炎症期に温めると炎症を助長するため禁忌です。冷却（アイシング）やMCRなどが適応です。",s:"一般知識"},
    {q:"電気療法で、電極パッドの密着が悪いとどうなるか？",o:["火傷のリスクが高まる","効果が上がる","電気が強くなる","何も起きない"],c:0,r:"接触面積が小さくなり電流密度が高まるため、刺すような痛みや火傷の原因になります。",s:"一般知識"},
    {q:"感覚神経（Aβ線維）を刺激して痛みを抑える理論は？",o:["ゲートコントロール理論","のれん分け理論","相対性理論","量子論"],c:0,r:"太い神経線維からの入力が、痛みのゲートを閉じるという理論です。",s:"8ページ"},
    {q:"「1Hz」とはどういう状態か？",o:["1秒間に1回振動する","1分間に1回振動する","1秒間に10回振動する","動かない"],c:0,r:"周波数の基本単位です。",s:"4ページ"}
];

// 2つのプールを結合
const questionPool = poolPart1.concat(poolPart2);

// シャッフル関数
function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
}

// クイズ状態管理
let currentQuizSet = [];
let currentQuestionIndex = 0;
let score = 0;

// 定数
const QUESTIONS_PER_ROUND = 20; // 出題数を20問に設定

// DOM要素取得
const startScreen = document.getElementById('start-screen');
const quizScreen = document.getElementById('quiz-screen');
const resultScreen = document.getElementById('result-screen');
const questionBox = document.getElementById('question');
const optionsBox = document.getElementById('options');
const feedbackBox = document.getElementById('feedback');
const nextBtn = document.getElementById('next-btn');
const progress = document.getElementById('progress');
const scoreDisplay = document.getElementById('score');

// クイズ開始
function startQuiz() {
    // 全問題からランダムに20問抽出
    currentQuizSet = shuffle([...questionPool]).slice(0, QUESTIONS_PER_ROUND);
    currentQuestionIndex = 0;
    score = 0;
    
    startScreen.style.display = 'none';
    resultScreen.style.display = 'none';
    quizScreen.style.display = 'block';
    
    showQuestion();
}

// リセット（最初に戻る）
function resetQuiz(force = false) {
    if (force || confirm("最初の画面に戻りますか？")) {
        startScreen.style.display = 'block';
        quizScreen.style.display = 'none';
        resultScreen.style.display = 'none';
    }
}

// 問題表示
function showQuestion() {
    const q = currentQuizSet[currentQuestionIndex];
    questionBox.textContent = `Q${currentQuestionIndex + 1}. ${q.q}`;
    optionsBox.innerHTML = '';
    feedbackBox.style.display = 'none';
    feedbackBox.className = 'feedback';
    nextBtn.classList.remove('active');
    
    progress.textContent = `問 ${currentQuestionIndex + 1} / ${QUESTIONS_PER_ROUND}`;
    scoreDisplay.textContent = `正解数: ${score}`;

    q.o.forEach((option, index) => {
        const btn = document.createElement('button');
        btn.className = 'option-btn';
        btn.textContent = option;
        btn.onclick = () => checkAnswer(index, btn, q);
        optionsBox.appendChild(btn);
    });
}

// 正誤判定
function checkAnswer(selectedIndex, selectedBtn, q) {
    if (nextBtn.classList.contains('active')) return;

    const isCorrect = (selectedIndex === q.c);
    const allBtns = document.querySelectorAll('.option-btn');

    if (isCorrect) {
        selectedBtn.classList.add('correct');
        feedbackBox.innerHTML = `<strong>正解！</strong><br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback';
        score++;
        scoreDisplay.textContent = `正解数: ${score}`;
    } else {
        selectedBtn.classList.add('incorrect');
        allBtns[q.c].classList.add('correct');
        feedbackBox.innerHTML = `<strong>不正解...</strong><br>正解は「${q.o[q.c]}」です。<br>${q.r}<span class="source-ref">参照：${q.s}</span>`;
        feedbackBox.className = 'feedback error';
    }

    feedbackBox.style.display = 'block';
    nextBtn.classList.add('active');
}

// 次の問題へ
function nextQuestion() {
    currentQuestionIndex++;
    if (currentQuestionIndex < QUESTIONS_PER_ROUND) {
        showQuestion();
    } else {
        showResult();
    }
}

// 結果画面
function showResult() {
    quizScreen.style.display = 'none';
    resultScreen.style.display = 'block';
    
    const finalScoreEl = document.getElementById('final-score');
    const commentEl = document.getElementById('result-comment');
    
    finalScoreEl.textContent = score;
    
    const percentage = (score / QUESTIONS_PER_ROUND) * 100;
    let comment = "";
    let color = "";

    if (percentage === 100) {
        comment = "完璧です！物療マニュアルを完全にマスターしています。";
        color = "#27ae60"; // Green
    } else if (percentage >= 80) {
        comment = "素晴らしい！合格ライン達成です。現場で活かしましょう。";
        color = "#d35400"; // Orange
    } else if (percentage >= 60) {
        comment = "惜しい！あと少しです。間違えた箇所を復習しましょう。";
        color = "#f39c12"; // Yellow
    } else {
        comment = "知識の定着が必要です。マニュアルを読み返して再挑戦しましょう。";
        color = "#c0392b"; // Red
    }

    commentEl.textContent = comment;
    commentEl.style.color = color;
}
</script>
</body>
</html>
